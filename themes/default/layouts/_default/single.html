{{- define "main" }}

{{ $currentSlug := .File.ContentBaseName }}
{{ range .Site.Data.posts.posts }}
  {{ if eq .slug $currentSlug }}
    <article class="post-single">
      <header class="post-header">
        <h1 class="post-title">{{ .content.intro.heading }}</h1>
        <div class="post-meta">
          {{- if .date }}
          <span class="post-date">
            {{- .date | time.Format ":date_long" -}}
          </span>
          {{- end }}
        </div>
      </header>

      <div class="post-content">
        <p>{{ .content.intro.text }}</p>

        {{ range .content.sections }}
          <h2>{{ .heading }}</h2>
          {{ range .subsections }}
            <h3>{{ .title }}</h3>
            <ul>
              {{ range .points }}
                <li>{{ . }}</li>
              {{ end }}
            </ul>
          {{ end }}
        {{ end }}

        {{ with .content.tables }}
          {{ range . }}
            <h2>{{ .title }}</h2>
            <div class="table-wrapper">
              <table>
                <thead>
                  <tr>
                    {{ range .headers }}
                      <th>{{ . }}</th>
                    {{ end }}
                  </tr>
                </thead>
                <tbody>
                  {{ range .rows }}
                    <tr>
                      {{ range . }}
                        <td>{{ . }}</td>
                      {{ end }}
                    </tr>
                  {{ end }}
                </tbody>
              </table>
            </div>
          {{ end }}
        {{ end }}

        {{ with .content.quote }}
          <blockquote>
            <p>{{ .text }}</p>
            <cite>- {{ .author }}</cite>
          </blockquote>
        {{ end }}

        {{ with .content.conclusion }}
          <p>{{ .text }}</p>
        {{ end }}
      </div>
    </article>
  {{ end }}
{{ end }}

{{- end }}
